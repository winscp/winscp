<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="AUTHOR" content="Dieter Steinwedel">
<meta name="DESCRIPTION"
content="Drag&amp;Drop component for Delphi; description for TDragDropFiles">
<meta name="KEYWORDS"
content="delphi, drag, drop, component, file, files, com, ole, freeware, windows">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
<title>Details about TDragDropFiles</title>
</head>

<body bgcolor="#FFFFEF">

<table border="0" cellspacing="0" width="600" bgcolor="#008080">
    <tr>
        <td width="10">&nbsp;</td>
        <td width="580">&nbsp;</td>
        <td width="10" bgcolor="#FFFFEF">&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><p align="center"><font color="#FFFFFF" size="7"
        face="Arial">TDragDropFiles</font></p>
        </td>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td bgcolor="#FFFFEF">&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
</table>

<p align="left">&nbsp;</p>

<p align="left">&nbsp;</p>

<table border="0" width="600">
    <tr>
        <td width="10" bgcolor="#008080" height="10">&nbsp; </td>
        <td rowspan="2" width="590"><font size="5" face="Arial">Description</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><font face="Arial"><b><i>TDragDropFiles</i></b> is a
        comfortable and powerful component for COM/OLE
        drag&amp;drop operations with files. The component is a
        child-class from </font><a href="TDragDrop.htm"><font
        face="Arial"><b><i>TDragDrop</i></b></font></a><font
        face="Arial">.</font> <p><font face="Arial">IMPORTANT: <b><i>TDragDropFiles
        </i></b>doesn't support shortcuts to files like <b><i>TDragDropFilesEx</i></b>.</font></p>
        </td>
    </tr>
    <tr>
        <td height="50">&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
</table>

<table border="0" width="600">
    <tr>
        <td width="10" bgcolor="#008080" height="10">&nbsp; </td>
        <td rowspan="2" width="590"><font size="5" face="Arial">Important
        for Use</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><font face="Arial">This </font><a href="Index.htm"><font
        face="Arial">file</font></a><font face="Arial">
        (index.htm) contains more information about restrictions,
        the disclaimer, remarks etc.</font></td>
    </tr>
    <tr>
        <td height="50">&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
</table>

<table border="0" width="600">
    <tr>
        <td width="10" bgcolor="#008080" height="10">&nbsp; </td>
        <td rowspan="2" width="590"><font size="5" face="Arial">History</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><font face="Arial"><b>Version 3.10</b> </font><font
        color="#808080" face="Arial">published on 06-Jul-1999</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><ul>
            <li><font face="Arial">Code re-design in result of
                modifications in <b><i>TDragDrop</i></b>;
                handling hasn't changed </font></li>
        </ul>
        </td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><font face="Arial"><b>Version 3.01</b> </font><font
        color="#808080" face="Arial">published on 07-Oct-1998</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><ul>
            <li><font face="Arial">small invisible bugs fixed</font></li>
        </ul>
        </td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><font face="Arial"><b>Version 3.00</b> </font><font
        color="#808080" face="Arial">published on 03-Oct-1998</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><dir>
            <li><font face="Arial">Total internal redesign due to
                modifications of the super-class, but the
                handling hasn't changed </font></li>
            <li><font face="Arial">component's icon has changed</font>
            </li>
        </dir>
        </td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><font face="Arial"><b>Version 2.00</b> </font><font
        color="#808080" face="Arial">published on 06-Aug-1999</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><ul>
            <li><font face="Arial">Internal structure was totally
                re-designed (has now the mother-class <b><i>TDragDrop</i></b>),
                but the handling hasn't changed</font> </li>
        </ul>
        </td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><font face="Arial"><b>Version 1.03</b> </font><font
        color="#808080" face="Arial">published on 29-Jun-1998</font><font
        face="Arial"> </font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><ul>
            <li><font face="Arial">A bug was removed (accepting
                files)</font> </li>
        </ul>
        </td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><font face="Arial"><b>Version 1.02</b> </font><font
        color="#808080" face="Arial">published on 10-Jun-1998</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><ul>
            <li><font face="Arial">The result of the method <b><i>ExecuteDragDrop</i></b>
                has changed (new result type)</font> </li>
        </ul>
        </td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><font face="Arial"><b>Version 1.01</b> </font><font
        color="#808080" face="Arial">published on 03-Feb-1998</font><font
        face="Arial"> </font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><ul>
            <li><font face="Arial">Some properties were added </font></li>
            <li><font face="Arial">New demo </font></li>
            <li><font face="Arial">New handling on dwEffect</font>
            </li>
        </ul>
        </td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><font face="Arial"><b>Version 1.00</b> </font><font
        color="#808080" face="Arial">published on 11-Nov-1997</font><font
        face="Arial"> </font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><ul>
            <li><font face="Arial">First official release</font> </li>
        </ul>
        </td>
    </tr>
    <tr>
        <td height="50">&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
</table>

<table border="0" width="600">
    <tr>
        <td width="10" bgcolor="#008080" height="10">&nbsp; </td>
        <td rowspan="2" width="590"><font size="5" face="Arial">Properties</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
</table>

<table border="0" cellpadding="3" cellspacing="0" width="600">
    <tr>
        <td width="10">&nbsp;</td>
        <td bgcolor="#008080"><font color="#FFFFFF" size="5"
        face="Arial"><strong>inherited properties</strong></font></td>
    </tr>
    <tr>
        <td rowspan="2">&nbsp;</td>
        <td bgcolor="#FFFFCC"><a href="TDragDrop.htm#Properties"><font
        face="Arial">Click here ...</font></a></td>
    </tr>
    <tr>
        <td bgcolor="#FFFFEF">&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td bgcolor="#008080"><a name="FileList"><font
        color="#FFFFFF" size="5" face="Arial"><b>FileList</b></font></a><font
        color="#FFFFFF" size="5" face="Arial"><b> </b></font><font
        color="#FFFF80" size="2" face="Arial"><b><i>public</i></b></font></td>
    </tr>
    <tr>
        <td rowspan="2">&nbsp;</td>
        <td bgcolor="#FFFFCC"><font size="3" face="Arial"><b>For
        Target:</b> Use this stringlist in </font><a
        href="TDragDrop.htm#OnProcessDropped"><font size="3"
        face="Arial"><b><i>OnProcessDropped</i></b></font></a><font
        size="3" face="Arial">, if you want to get the dropped
        files.</font><p><font size="3" face="Arial"><b>For
        Source:</b> Add the files to the stringlist, which you
        want to d&amp;d, before calling </font><a href="#Execute"><font
        size="3" face="Arial"><b><i>Execute</i></b></font></a><font
        size="3" face="Arial">. </font></p>
        </td>
    </tr>
    <tr>
        <td bgcolor="#FFFFEF" height="50">&nbsp;</td>
    </tr>
</table>

<table border="0" width="600">
    <tr>
        <td width="10" bgcolor="#008080" height="10">&nbsp; </td>
        <td rowspan="2" width="590"><font size="5" face="Arial">Events</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
</table>

<table border="0" cellpadding="3" cellspacing="0" width="600">
    <tr>
        <td width="10">&nbsp;</td>
        <td bgcolor="#008080"><font color="#FFFFFF" size="5"
        face="Arial"><strong>inherited events</strong></font></td>
    </tr>
    <tr>
        <td rowspan="2">&nbsp;</td>
        <td bgcolor="#FFFFCC"><a href="TDragDrop.htm#Events"><font
        face="Arial">Click here ...</font></a></td>
    </tr>
    <tr>
        <td bgcolor="#FFFFEF" height="50">&nbsp;</td>
    </tr>
</table>

<table border="0" width="600">
    <tr>
        <td width="10" bgcolor="#008080" height="10">&nbsp;</td>
        <td rowspan="2" width="590"><font size="5" face="Arial">Methods</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
</table>

<table border="0" cellpadding="3" cellspacing="0" width="600">
    <tr>
        <td width="10">&nbsp;</td>
        <td bgcolor="#008080"><font color="#FFFFFF" size="5"
        face="Arial"><strong>inherited methods</strong></font></td>
    </tr>
    <tr>
        <td rowspan="2">&nbsp;</td>
        <td bgcolor="#FFFFCC"><a href="TDragDrop.htm#Methods"><font
        face="Arial">Click here ...</font></a></td>
    </tr>
    <tr>
        <td bgcolor="#FFFFEF">&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td bgcolor="#008080"><a name="Execute"><font
        color="#FFFFFF" size="5" face="Arial"><b>Execute</b></font></a><font
        color="#FFFFFF" size="5" face="Arial"><b> </b></font><font
        color="#FFFF80" size="2" face="Arial"><b><i>public</i></b></font></td>
    </tr>
    <tr>
        <td rowspan="2">&nbsp;</td>
        <td bgcolor="#FFFFCC"><font size="3" face="Arial">Call
        this method, if you detect that the user wants to start a
        drag&amp;drop operation (e.g.: MouseDown+MouseMove). Also
        look: </font><a href="#FileList"><font size="3"
        face="Arial"><em><strong>FileList</strong></em></font></a><font
        size="3" face="Arial">.</font><p><font size="3"
        face="Arial">For drag detection you can also use the
        inherited property </font><a
        href="TDragDrop.htm#AutoDetectDnD"><font size="3"
        face="Arial"><em><strong>AutotDetectDnD</strong></em></font></a><font
        size="3" face="Arial"> or the method </font><a
        href="TDragDrop.htm#StartDnDDetection"><font size="3"
        face="Arial"><em><strong>StartDnDDetection</strong></em></font></a><font
        size="3" face="Arial">.</font></p>
        <p><font size="3" face="Arial">IMPORTANT: If you use the
        drag-detection, it's high recommended to check the
        section &quot;</font><a
        href="TDragDrop.htm#DragDetectionProblem"><font size="3"
        face="Arial">Problems With The Drag-Detection</font></a><font
        size="3" face="Arial">&quot;.</font></p>
        </td>
    </tr>
    <tr>
        <td bgcolor="#FFFFEF" height="50">&nbsp;</td>
    </tr>
</table>

<table border="0" width="600">
    <tr>
        <td width="10" bgcolor="#008080" height="10">&nbsp;</td>
        <td rowspan="2" colspan="2" width="590"><font size="5"
        face="Arial">How Do I Use It As Drag&amp;Drop Source</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><font face="Arial">1.</font></td>
        <td><font face="Arial">Drop a TWinControl on the form
        (e.g. a listbox).</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><font face="Arial">2.</font></td>
        <td><font face="Arial">Choose the TWinControl (listbox)
        in </font><a href="TDragDrop.htm#DragDropControl"><font
        face="Arial"><em><strong>DragDropControl</strong></em></font></a><font
        face="Arial">.</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><font face="Arial">3. </font></td>
        <td><font face="Arial">Choose the drag&amp;drop effects
        under </font><a href="TDragDrop.htm#SourceEffects"><font
        face="Arial"><em><strong>SourceEffects</strong></em></font></a><font
        face="Arial"> which the <em><strong>DragDropControl </strong></em>(listbox)
        should support. If you don't want any longer that the <em><strong>DragDropControl</strong></em>
        serve as drag&amp;drop source all items must be set to
        false.</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><font face="Arial">4.</font></td>
        <td><font face="Arial">Now, your <em><strong>DragDropControl</strong></em>
        (listbox) must detect, when the user wants to start a
        drag&amp;drop operation. You can use the event
        &quot;OnMouseDown&quot; of your <em><strong>DragDropControl</strong></em>
        (listbox). Add following to the event:</font><blockquote>
            <p><font face="Arial"><code>DragDropFiles1.FileList.add(&lt;selected
            items of the </code></font><a
            href="TDragDrop.htm#DragDropControl"><font
            face="Arial"><code><em><strong>DragDropControl</strong></em></code></font></a><font
            face="Arial"><code><em><strong> </strong></em></code><code>(listbox)&gt;);</code></font></p>
        </blockquote>
        <p><font face="Arial">You must add the filenames
        including the WHOLE PATH!!!</font></p>
        </td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><font face="Arial">5.</font></td>
        <td valign="top"><font face="Arial">Tell Windows that
        there is a drag&amp;drop operation to handle: Just call
        the method </font><a href="TDragDrop.htm#Execute"><font
        face="Arial"><em><strong>Execute</strong></em></font></a><font
        face="Arial"> of this component. </font></td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top"><font face="Arial">6.</font></td>
        <td valign="top"><font size="3" face="Arial">You may use
        the events </font><a href="TDragDrop.htm#OnGiveFeedback"><font
        size="3" face="Arial"><b><i>OnGiveFeedback</i></b></font></a><font
        size="3" face="Arial"> and </font><a
        href="TDragDrop.htm#OnQueryContinueDrag"><font size="3"
        face="Arial"><b><i>OnQueryContinueDrag</i></b></font></a><font
        size="3" face="Arial">, but often you need not.</font></td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top" colspan="2"><font face="Arial"><strong>Hints:</strong></font></td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top" colspan="2"><ul>
            <li><font size="3" face="Arial">Drag&amp;drop
                operations cannot be done at design-time!</font></li>
            <li><font size="3" face="Arial">IMPORTANT: If you use
                the drag-detection, it's high recommended to
                check the section &quot;</font><a
                href="TDragDrop.htm#DragDetectionProblem"><font
                size="3" face="Arial">Problems With The
                Drag-Detection</font></a><font size="3"
                face="Arial">&quot;.</font></li>
        </ul>
        </td>
    </tr>
    <tr>
        <td height="50">&nbsp;</td>
        <td colspan="2">&nbsp;</td>
    </tr>
</table>

<table border="0" width="600">
    <tr>
        <td width="10" bgcolor="#008080" height="10">&nbsp;</td>
        <td rowspan="2" colspan="2" width="590"><font size="5"
        face="Arial">How Do I Use It As Drag&amp;Drop Target</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><font face="Arial">1.</font></td>
        <td><font face="Arial">Drop a TWinControl on the form
        (e.g. a listbox).</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><font face="Arial">2.</font></td>
        <td><font face="Arial">Choose the TWinControl (listbox)
        in </font><a href="TDragDrop.htm#DragDropControl"><font
        face="Arial"><em><strong>DragDropControl</strong></em></font></a><font
        face="Arial">.</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><font face="Arial">3. </font></td>
        <td><font face="Arial">Choose the drag&amp;drop effects
        under </font><a href="TDragDrop.htm#TargetEffects"><font
        face="Arial"><em><strong>TargetEffects</strong></em></font></a><font
        face="Arial"> which the <em><strong>DragDropControl </strong></em>(listbox)
        should support. If you don't want any longer that the <em><strong>DragDropControl</strong></em>
        serve as drag&amp;drop target all items must be set to
        false.</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><font face="Arial">4.</font></td>
        <td><font size="3" face="Arial">Now, you have to program
        what happen, if the user drops files on your </font><a
        href="TDragDrop.htm#DragDropControl"><font size="3"
        face="Arial"><b><i>DragDropControl</i></b></font></a><font
        size="3" face="Arial"> (listbox). For this, the best is
        to use the event </font><a
        href="TDragDrop.htm#OnProcessDropped"><font size="3"
        face="Arial"><b><i>OnProcessDropped</i></b></font></a><font
        size="3" face="Arial">. At first, you should check what
        drag&amp;drop effect was chosen by the user. You get the
        effect from method's parameter <b><i>dwEffect</i></b>.
        You get the filenames from this component with following
        line:</font><blockquote>
            <p><font face="Arial"><code>...:=DragDropFiles1.FileList[&lt;Index&gt;];</code></font></p>
        </blockquote>
        <p><a href="#FileList"><font size="3" face="Arial"><b><i>FileList</i></b></font></a><font
        size="3" face="Arial"> is a stringlist. For more info
        check the Delphi's online-help. Now, do with the files
        what you have to do, e.g. copy, move, delete, etc.</font></p>
        </td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><font face="Arial">5.</font></td>
        <td valign="top"><font size="3" face="Arial">You may use
        the events </font><a href="TDragDrop.htm#OnDragEnter"><font
        size="3" face="Arial"><b><i>OnDragEnter</i></b></font></a><font
        size="3" face="Arial">, </font><a
        href="TDragDrop.htm#OnDragOver"><font size="3"
        face="Arial"><b><i>OnDragOver</i></b></font></a><font
        size="3" face="Arial"> and </font><a
        href="TDragDrop.htm#OnDragLeave"><font size="3"
        face="Arial"><b><i>OnDragLeave</i></b></font></a><font
        size="3" face="Arial">, but often you need not.</font></td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top" colspan="2"><font face="Arial"><strong>Hints:</strong></font></td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top" colspan="2"><ul>
            <li><font size="3" face="Arial">Drag&amp;drop
                operations cannot be done at design-time!</font></li>
        </ul>
        </td>
    </tr>
    <tr>
        <td height="50">&nbsp;</td>
        <td colspan="2">&nbsp;</td>
    </tr>
</table>

<table border="0" width="600">
    <tr>
        <td width="10" bgcolor="#008080" height="10">&nbsp;</td>
        <td rowspan="2" width="590"><font size="5" face="Arial">FAQ</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><font size="3" face="Arial"><b>Q:</b> My application
        supports only some special file-formats. How can I forbid
        the other formats during the drop?</font><p><font
        size="3" face="Arial"><b>A:</b> Set the property </font><a
        href="TDragDrop.htm#RenderOn"><font size="3" face="Arial"><em><strong>RenderOn</strong></em></font></a><font
        size="3" face="Arial"> to <b><i>rdoDropEnterAndDropSync</i></b>
        and check out the </font><a href="#FileList"><font
        size="3" face="Arial"><em><strong>Filelist</strong></em></font></a><font
        size="3" face="Arial"> in the event </font><a
        href="TDragDrop.htm#OnDragEnter"><font size="3"
        face="Arial"><b><i>OnDragEnter</i></b></font></a><font
        size="3" face="Arial">. Set the parameter <em><strong>Accept</strong></em>
        in this event to true, if your application support the
        files in the <em><strong>Filelist</strong></em> otherwise
        set the parameter to false. If you only use the first
        file, check only the first item in the <em><strong>Filelist</strong></em>.</font></p>
        </td>
    </tr>
    <tr>
        <td height="50">&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
</table>

<table border="0" width="600">
    <tr>
        <td width="10" bgcolor="#008080" height="10">&nbsp; </td>
        <td rowspan="2" width="590"><font size="5" face="Arial">Known
        Bugs</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><ul>
            <li><font size="3" face="Arial">Shortcuts to desktop
                or explorer, etc. aren't possible. You must use
                the component </font><a
                href="TDragDropFilesEx.htm"><font size="3"
                face="Arial"><b><i>TDragDropFilesEx</i></b></font></a><font
                size="3" face="Arial"> to have this feature. </font></li>
        </ul>
        </td>
    </tr>
    <tr>
        <td height="50">&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
</table>

<hr>

<p><font size="3" face="Arial"><i>© 1998,99 by </i></font><a
href="mailto:dsteinwe@uos.de"><font size="3" face="Arial"><i>Dieter
Steinwedel</i></font></a><font size="3" face="Arial"> </font></p>

<p><a href="Index.htm"><font face="Arial">Back</font></a><font
face="Arial"> to index</font></p>
</body>
</html>
