<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="AUTHOR" content="Dieter Steinwedel">
<meta name="DESCRIPTION"
content="Drag&amp;Drop component for Delphi; description for TDragDropURL">
<meta name="KEYWORDS"
content="delphi, drag, drop, component, url, com, ole, freeware, windows">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
<title>Details about TDragDropURL</title>
</head>

<body bgcolor="#FFFFEF">

<table border="0" cellspacing="0" width="600" bgcolor="#008080">
    <tr>
        <td width="10">&nbsp;</td>
        <td width="580">&nbsp;</td>
        <td width="10" bgcolor="#FFFFEF">&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><p align="center"><font color="#FFFFFF" size="7"
        face="Arial">TDragDropURL</font></p>
        </td>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td bgcolor="#FFFFEF">&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
</table>

<p align="left">&nbsp;</p>

<p align="left">&nbsp;</p>

<table border="0" width="600">
    <tr>
        <td width="10" bgcolor="#008080" height="10">&nbsp; </td>
        <td rowspan="2" width="590"><font size="5" face="Arial">Description</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><font face="Arial"><b><i>TDragDropURL</i></b> is a
        comfortable and powerful component for COM/OLE drag&amp;drop
        operations with URLs. The component is a child-class from
        </font><a href="TDragDrop.htm"><font face="Arial"><b><i>TDragDrop</i></b></font></a><font
        face="Arial">.</font></td>
    </tr>
    <tr>
        <td height="50">&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
</table>

<table border="0" width="600">
    <tr>
        <td width="10" bgcolor="#008080" height="10">&nbsp; </td>
        <td rowspan="2" width="590"><font size="5" face="Arial">Important
        for Use</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><font face="Arial">This </font><a href="Index.htm"><font
        face="Arial">file</font></a><font face="Arial"> (index.htm)
        contains more information about restrictions, the
        disclaimer, remarks etc.</font></td>
    </tr>
    <tr>
        <td height="50">&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
</table>

<table border="0" width="600">
    <tr>
        <td width="10" bgcolor="#008080" height="10">&nbsp; </td>
        <td rowspan="2" width="590"><font size="5" face="Arial">History</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><font face="Arial"><b>Version 1.10</b> </font><font
        color="#808080" face="Arial">published on 06-Jul-1999</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><ul>
            <li><font face="Arial">Code re-design in result of
                modifications in <b><i>TDragDrop</i></b>;
                handling hasn't changed</font></li>
            <li><font size="3" face="Arial">In result of the code
                re-design the clipboard-bug under Win95 was fixed
                </font></li>
        </ul>
        </td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><font face="Arial"><b>Version 1.00</b> </font><font
        color="#808080" face="Arial">published on 06-Aug-1998</font><font
        face="Arial"> </font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><ul>
            <li><font face="Arial">First official release</font></li>
        </ul>
        </td>
    </tr>
    <tr>
        <td height="50">&nbsp;</td>
        <td colspan="2">&nbsp;</td>
    </tr>
</table>

<table border="0" width="600">
    <tr>
        <td width="10" bgcolor="#008080" height="10">&nbsp; </td>
        <td rowspan="2" width="590"><font size="5" face="Arial">Properties</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
</table>

<table border="0" cellpadding="3" cellspacing="0" width="600">
    <tr>
        <td width="10">&nbsp;</td>
        <td bgcolor="#008080"><font color="#FFFFFF" size="5"
        face="Arial"><strong>inherited properties</strong></font></td>
    </tr>
    <tr>
        <td rowspan="2">&nbsp;</td>
        <td bgcolor="#FFFFCC"><a href="TDragDrop.htm#Properties"><font
        face="Arial">Click here ...</font></a></td>
    </tr>
    <tr>
        <td bgcolor="#FFFFEF">&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td bgcolor="#008080"><font color="#FFFFFF" size="5"
        face="Arial"><b>ScrapFileName </b></font><font
        color="#FFFF80" size="2" face="Arial"><b><i>public</i></b></font></td>
    </tr>
    <tr>
        <td rowspan="2">&nbsp;</td>
        <td bgcolor="#FFFFCC"><font size="3" face="Arial">If you
        drop the URL string on the desktop, there will be created
        a link to the URL. These link files are called &quot;scrap
        files&quot;. You can set the name of this file with this
        property. </font></td>
    </tr>
    <tr>
        <td bgcolor="#FFFFEF">&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td bgcolor="#008080"><a name="URL"><font color="#FFFFFF"
        size="5" face="Arial"><b>URL</b></font></a><font
        color="#FFFFFF" size="5" face="Arial"><b> </b></font><font
        color="#FFFF80" size="2" face="Arial"><b><i>public</i></b></font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td bgcolor="#FFFFCC"><font size="3" face="Arial"><b>For
        Target:</b> Use this string in </font><a
        href="TDragDrop.htm#OnProcessDropped"><font size="3"
        face="Arial"><b><i>OnProcessDropped</i></b></font></a><font
        size="3" face="Arial">, if you want to get the dropped
        URL.</font><p><font size="3" face="Arial"><b>For Source:</b>
        Add the URL to this string, which you want to drag&amp;drop,
        before calling </font><a href="#Execute"><font size="3"
        face="Arial"><b><i>Execute</i></b></font></a><font
        size="3" face="Arial">. </font></p>
        </td>
    </tr>
    <tr>
        <td height="50">&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
</table>

<table border="0" width="600">
    <tr>
        <td width="10" bgcolor="#008080" height="10">&nbsp; </td>
        <td rowspan="2" width="590"><font size="5" face="Arial">Events</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
</table>

<table border="0" cellpadding="3" cellspacing="0" width="600">
    <tr>
        <td width="10">&nbsp;</td>
        <td bgcolor="#008080"><font color="#FFFFFF" size="5"
        face="Arial"><strong>inherited events</strong></font></td>
    </tr>
    <tr>
        <td rowspan="2">&nbsp;</td>
        <td bgcolor="#FFFFCC"><a href="TDragDrop.htm#Events"><font
        face="Arial">Click here ...</font></a></td>
    </tr>
    <tr>
        <td bgcolor="#FFFFEF" height="50">&nbsp;</td>
    </tr>
</table>

<table border="0" width="600">
    <tr>
        <td width="10" bgcolor="#008080" height="10">&nbsp;</td>
        <td rowspan="2" width="590"><font size="5" face="Arial">Methods</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
</table>

<table border="0" cellpadding="3" cellspacing="0" width="600">
    <tr>
        <td width="10">&nbsp;</td>
        <td bgcolor="#008080"><font color="#FFFFFF" size="5"
        face="Arial"><strong>inherited methods</strong></font></td>
    </tr>
    <tr>
        <td rowspan="2">&nbsp;</td>
        <td bgcolor="#FFFFCC"><a href="TDragDrop.htm#Methods"><font
        face="Arial">Click here ...</font></a></td>
    </tr>
    <tr>
        <td bgcolor="#FFFFEF">&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td bgcolor="#008080"><a name="Execute"><font
        color="#FFFFFF" size="5" face="Arial"><b>Execute</b></font></a><font
        color="#FFFFFF" size="5" face="Arial"><b> </b></font><font
        color="#FFFF80" size="2" face="Arial"><b><i>public</i></b></font></td>
    </tr>
    <tr>
        <td rowspan="2">&nbsp;</td>
        <td bgcolor="#FFFFCC"><font size="3" face="Arial">Call
        this method, if you detect that the user wants to start a
        drag&amp;drop operation (e.g. MouseDown+MouseMove). Also
        look: </font><a href="#URL"><font size="3" face="Arial"><em><strong>URL</strong></em></font></a><font
        size="3" face="Arial">.</font><p><font size="3"
        face="Arial">For drag detection you can also use the
        inherited property </font><a
        href="TDragDrop.htm#AutoDetectDnD"><font size="3"
        face="Arial"><em><strong>AutotDetectDnD</strong></em></font></a><font
        size="3" face="Arial"> or the method </font><a
        href="TDragDrop.htm#StartDnDDetection"><font size="3"
        face="Arial"><em><strong>StartDnDDetection</strong></em></font></a><font
        size="3" face="Arial">.</font></p>
        <p><font size="3" face="Arial">IMPORTANT: If you use the
        drag-detection, it's high recommended to check the
        section &quot;</font><a
        href="TDragDrop.htm#DragDetectionProblem"><font size="3"
        face="Arial">Problems With The Drag-Detection</font></a><font
        size="3" face="Arial">&quot;.</font></p>
        </td>
    </tr>
    <tr>
        <td bgcolor="#FFFFEF" height="50">&nbsp;</td>
    </tr>
</table>

<table border="0" width="600">
    <tr>
        <td width="10" bgcolor="#008080" height="10">&nbsp;</td>
        <td rowspan="2" colspan="2" width="590"><font size="5"
        face="Arial">How Do I Use It As Drag&amp;Drop Source</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><font face="Arial">1.</font></td>
        <td><font face="Arial">Drop a TWinControl on the form (e.g.
        a memo).</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><font face="Arial">2.</font></td>
        <td><font face="Arial">Choose the TWinControl (memo) in </font><a
        href="TDragDrop.htm#DragDropControl"><font face="Arial"><em><strong>DragDropControl</strong></em></font></a><font
        face="Arial">.</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><font face="Arial">3. </font></td>
        <td><font face="Arial">Choose the drag&amp;drop effects
        under </font><a href="TDragDrop.htm#SourceEffects"><font
        face="Arial"><em><strong>SourceEffects</strong></em></font></a><font
        face="Arial"> which the <em><strong>DragDropControl </strong></em>(memo)
        should support. If you don't want any longer that the <em><strong>DragDropControl</strong></em>
        serve as drag&amp;drop source all items must be set to
        false.</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><font face="Arial">4.</font></td>
        <td><font face="Arial">Now, your <em><strong>DragDropControl</strong></em>
        (memo) must detect, when the user wants to start a drag&amp;drop
        operation. You can use the event &quot;OnMouseDown&quot;
        of your <em><strong>DragDropControl</strong></em> (memo).
        Add following to the event:</font><blockquote>
            <p><font face="Arial"><code>DragDropURL1.URL:=&lt;selection
            of </code></font><a
            href="TDragDrop.htm#DragDropControl"><font
            face="Arial"><code><em><strong>DragDropControl</strong></em></code></font></a><font
            face="Arial"><code> (memo)&gt;);</code></font></p>
        </blockquote>
        </td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><font face="Arial">5.</font></td>
        <td valign="top"><font face="Arial">Tell Windows that
        there is a drag&amp;drop operation to handle: Just call
        the method </font><a href="TDragDrop.htm#Execute"><font
        face="Arial"><em><strong>Execute</strong></em></font></a><font
        face="Arial"> of this component. </font></td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top"><font face="Arial">6.</font></td>
        <td valign="top"><font size="3" face="Arial">You may use
        the events </font><a href="TDragDrop.htm#OnGiveFeedback"><font
        size="3" face="Arial"><b><i>OnGiveFeedback</i></b></font></a><font
        size="3" face="Arial"> and </font><a
        href="TDragDrop.htm#OnQueryContinueDrag"><font size="3"
        face="Arial"><b><i>OnQueryContinueDrag</i></b></font></a><font
        size="3" face="Arial">, but often you need not.</font></td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top" colspan="2"><font face="Arial"><strong>Hints:</strong></font></td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top" colspan="2"><ul>
            <li><font size="3" face="Arial">Drag&amp;drop
                operations cannot be done at design-time!</font></li>
            <li><font size="3" face="Arial">IMPORTANT: If you use
                the drag-detection, it's high recommended to
                check the section &quot;</font><a
                href="TDragDrop.htm#DragDetectionProblem"><font
                size="3" face="Arial">Problems With The Drag-Detection</font></a><font
                size="3" face="Arial">&quot;.</font></li>
        </ul>
        </td>
    </tr>
    <tr>
        <td height="50">&nbsp;</td>
        <td colspan="2">&nbsp;</td>
    </tr>
</table>

<table border="0" width="600">
    <tr>
        <td width="10" bgcolor="#008080" height="10">&nbsp;</td>
        <td rowspan="2" colspan="2" width="590"><font size="5"
        face="Arial">How Do I Use It As Drag&amp;Drop Target</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><font face="Arial">1.</font></td>
        <td><font face="Arial">Drop a TWinControl on the form (e.g.
        a memo).</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><font face="Arial">2.</font></td>
        <td><font face="Arial">Choose the TWinControl (memo) in </font><a
        href="TDragDrop.htm#DragDropControl"><font face="Arial"><em><strong>DragDropControl</strong></em></font></a><font
        face="Arial">.</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><font face="Arial">3. </font></td>
        <td><font face="Arial">Choose the drag&amp;drop effects
        under </font><a href="TDragDrop.htm#TargetEffects"><font
        face="Arial"><em><strong>TargetEffects</strong></em></font></a><font
        face="Arial"> which the <em><strong>DragDropControl </strong></em>(support.
        If you don't want any longer that the <em><strong>DragDropControl</strong></em>
        (memo) should serve as drag&amp;drop target all items
        must be set to false.</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><font face="Arial">4.</font></td>
        <td><font size="3" face="Arial">Now, you have to program
        what happen, if the user drops an URL on your </font><a
        href="TDragDrop.htm#DragDropControl"><font size="3"
        face="Arial"><b><i>DragDropControl</i></b></font></a><font
        size="3" face="Arial"> (memo). For this, the best is to
        use the event </font><a
        href="TDragDrop.htm#OnProcessDropped"><font size="3"
        face="Arial"><b><i>OnProcessDropped</i></b></font></a><font
        size="3" face="Arial">. At first, you should check what
        drag&amp;drop effect was chosen by the user. You get the
        effect from method's parameter <b><i>dwEffect</i></b>.
        You get the URL from this component with following line:</font><blockquote>
            <p><font face="Arial"><code>...:=DragDropURL1.URL;</code></font></p>
        </blockquote>
        </td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><font face="Arial">5.</font></td>
        <td valign="top"><font size="3" face="Arial">You may use
        the events </font><a href="TDragDrop.htm#OnDragEnter"><font
        size="3" face="Arial"><b><i>OnDragEnter</i></b></font></a><font
        size="3" face="Arial">, </font><a
        href="TDragDrop.htm#OnDragOver"><font size="3"
        face="Arial"><b><i>OnDragOver</i></b></font></a><font
        size="3" face="Arial"> and </font><a
        href="TDragDrop.htm#OnDragLeave"><font size="3"
        face="Arial"><b><i>OnDragLeave</i></b></font></a><font
        size="3" face="Arial">, but often you need not.</font></td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
        <td valign="top">&nbsp;</td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top" colspan="2"><font face="Arial"><strong>Hints:</strong></font></td>
    </tr>
    <tr>
        <td valign="top">&nbsp;</td>
        <td valign="top" colspan="2"><ul>
            <li><font size="3" face="Arial">Drag&amp;drop
                operations cannot be done at design-time!</font></li>
        </ul>
        </td>
    </tr>
    <tr>
        <td height="50">&nbsp;</td>
        <td colspan="2">&nbsp;</td>
    </tr>
</table>

<table border="0" width="600">
    <tr>
        <td width="10" bgcolor="#008080" height="10">&nbsp; </td>
        <td rowspan="2" width="590"><font size="5" face="Arial">Known
        Bugs</font></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td><ul>
            <li><font face="Arial">I hope, you never find one</font></li>
        </ul>
        </td>
    </tr>
    <tr>
        <td height="50">&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
</table>

<hr>

<p><font size="3" face="Arial"><i>© 1998,99 by </i></font><a
href="mailto:dsteinwe@uos.de"><font size="3" face="Arial"><i>Dieter
Steinwedel</i></font></a><font size="3" face="Arial"> </font></p>

<p><a href="Index.htm"><font face="Arial">Back</font></a><font
face="Arial"> to index</font></p>
</body>
</html>
